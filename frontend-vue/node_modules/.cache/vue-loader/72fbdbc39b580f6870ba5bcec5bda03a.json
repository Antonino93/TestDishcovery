{"remainingRequest":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\SVILUPPO\\test\\frontend-vue\\src\\views\\ProfileSettings.vue?vue&type=script&lang=ts&","dependencies":[{"path":"C:\\SVILUPPO\\test\\frontend-vue\\src\\views\\ProfileSettings.vue","mtime":1654451129841},{"path":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\ts-loader\\index.js","mtime":499162500000},{"path":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCmltcG9ydCB7IENvbXBvbmVudCwgVnVlLCBXYXRjaCB9IGZyb20gInZ1ZS1wcm9wZXJ0eS1kZWNvcmF0b3IiOw0KDQppbXBvcnQgQ29tbW9uRXJyb3JzTGlzdCBmcm9tICJAL2NvbXBvbmVudHMvQ29tbW9uRXJyb3JzTGlzdC52dWUiOw0KaW1wb3J0IENvbW1vbkxvYWRlciBmcm9tICJAL2NvbXBvbmVudHMvQ29tbW9uTG9hZGVyLnZ1ZSI7DQppbXBvcnQgeyBJQ3VycmVudFVzZXIgfSBmcm9tICJAL3N0b3JlL21vZGVscyI7DQppbXBvcnQgVXNlciBmcm9tICJAL3N0b3JlL21vZHVsZXMvVXNlciI7DQppbXBvcnQgeyBpc0FycmF5T2ZTdHJpbmdzIH0gZnJvbSAiQC91dGlscy9BcnJheVV0aWxzIjsNCg0KQENvbXBvbmVudCh7DQogIGNvbXBvbmVudHM6IHsNCiAgICBDb21tb25Mb2FkZXIsDQogICAgQ29tbW9uRXJyb3JzTGlzdA0KICB9DQp9KQ0KZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJvZmlsZVNldHRpbmdzIGV4dGVuZHMgVnVlIHsNCiAgaXNMb2FkaW5nID0gZmFsc2U7DQoNCiAgaW1hZ2U6IHN0cmluZyB8IG51bGwgPSBudWxsOw0KICBiaW8gPSAiIjsNCiAgZW1haWwgPSAiIjsNCiAgcGFzc3dvcmQ6IHN0cmluZyB8IG51bGwgPSBudWxsOw0KICB1c2VybmFtZSA9ICIiOw0KICBlcnJvcnM/OiBzdHJpbmdbXSA9IFtdOw0KICBzZWxlY3RlZEltYWdlID0gbnVsbDsNCg0KICBnZXQgaGFzRXJyb3JzKCk6IGJvb2xlYW4gew0KICAgIHJldHVybiAhIXRoaXMuZXJyb3JzPy5sZW5ndGg7DQogIH0NCg0KICBnZXQgY3VycmVudFVzZXIoKTogUGFydGlhbDxJQ3VycmVudFVzZXI+IHsNCiAgICByZXR1cm4gVXNlci5jdXJyZW50VXNlciB8fCB7fTsNCiAgfQ0KDQogIGxvZ291dCgpOiB2b2lkIHsNCiAgICBVc2VyLmxvZ291dCgpOw0KICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZTogdGhpcy4kcm91dGVzTmFtZXMuaG9tZSB9KTsNCiAgfQ0KDQogIHVwbG9hZEltYWdlKGV2ZW50OiBFdmVudCk6IHZvaWR7DQogICAgdGhpcy5zZWxlY3RlZEltYWdlID0gKGV2ZW50Py50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkuZmlsZXNbMF07DQogIH0NCg0KICBhc3luYyB1cGRhdGVTZXR0aW5ncygpOiBQcm9taXNlPHZvaWQ+IHsNCiAgICB0aGlzLmVycm9ycyA9IFtdOw0KDQogICAgY29uc3QgZmQgPSBuZXcgRm9ybURhdGEoKTsNCiAgICBmZC5hcHBlbmQoJ3VwbG9hZEltYWdlJywgdGhpcy5zZWxlY3RlZEltYWdlKTsNCiAgICBmZC5hcHBlbmQoJ2VtYWlsJywgdGhpcy5lbWFpbCk7DQogICAgZmQuYXBwZW5kKCdiaW8nLCB0aGlzLmJpbyk7DQogICAgZmQuYXBwZW5kKCdpbWFnZScsIHRoaXMuaW1hZ2UpOw0KICAgIGZkLmFwcGVuZCgncGFzc3dvcmQnLCB0aGlzLnBhc3N3b3JkKTsNCiAgICBmZC5hcHBlbmQoJ3VzZXJuYW1lJywgdGhpcy51c2VybmFtZSk7DQoNCiAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7DQogICAgdHJ5IHsNCiAgICAgIGF3YWl0IFVzZXIudXBkYXRlKHsNCiAgICAgICAgdXNlclVwZGF0ZTogZmQsDQogICAgICB9KTsNCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZTogdGhpcy4kcm91dGVzTmFtZXMuaG9tZSB9KTsNCiAgICB9IGNhdGNoIChlKSB7DQogICAgICBpZiAoaXNBcnJheU9mU3RyaW5ncyhlKSkgew0KICAgICAgICB0aGlzLmVycm9ycyA9IGU7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aHJvdyBlOw0KICAgICAgfQ0KICAgIH0gZmluYWxseSB7DQogICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlOw0KICAgIH0NCiAgfQ0KICBAV2F0Y2goImN1cnJlbnRVc2VyIiwgeyBpbW1lZGlhdGU6IHRydWUgfSkNCiAgb25DdXJyZW50VXNlckxvYWRlZChuZXdWYWx1ZTogSUN1cnJlbnRVc2VyKTogdm9pZCB7DQogICAgdGhpcy5lcnJvcnMgPSBbXTsNCiAgICBpZiAobmV3VmFsdWUpIHsNCiAgICAgIHRoaXMuaW1hZ2UgPSBuZXdWYWx1ZS5pbWFnZTsNCiAgICAgIHRoaXMuYmlvID0gbmV3VmFsdWUuYmlvOw0KICAgICAgdGhpcy5lbWFpbCA9IG5ld1ZhbHVlLmVtYWlsOw0KICAgICAgdGhpcy51c2VybmFtZSA9IG5ld1ZhbHVlLnVzZXJuYW1lOw0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["ProfileSettings.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2EA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ProfileSettings.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"settings-page\">\r\n    <div class=\"container page\">\r\n      <div class=\"row\">\r\n        <div class=\"col-md-6 offset-md-3 col-xs-12\">\r\n          <h1 class=\"text-xs-center\">Your Settings</h1>\r\n          <common-errors-list :errors=\"errors\" />\r\n          <form>\r\n            <fieldset :disabled=\"isLoading\">\r\n              <fieldset class=\"form-group\">\r\n                <input\r\n                  v-model=\"image\"\r\n                  class=\"form-control\"\r\n                  type=\"text\"\r\n                  placeholder=\"URL of profile picture\"\r\n                />\r\n              </fieldset>\r\n              <fieldset class=\"form-group\">\r\n                <input type=\"file\" accept=\"image/*\" @change=\"uploadImage\" />\r\n              </fieldset>\r\n              <fieldset class=\"form-group\">\r\n                <input\r\n                  v-model=\"username\"\r\n                  class=\"form-control form-control-lg\"\r\n                  type=\"text\"\r\n                  placeholder=\"Your Name\"\r\n                  required=\"true\"\r\n                />\r\n              </fieldset>\r\n              <fieldset class=\"form-group\">\r\n                <textarea\r\n                  v-model=\"bio\"\r\n                  class=\"form-control form-control-lg\"\r\n                  rows=\"8\"\r\n                  placeholder=\"Short bio about you\"\r\n                ></textarea>\r\n              </fieldset>\r\n              <fieldset class=\"form-group\">\r\n                <input\r\n                  v-model=\"email\"\r\n                  class=\"form-control form-control-lg\"\r\n                  type=\"email\"\r\n                  placeholder=\"Email\"\r\n                  required=\"true\"\r\n                />\r\n              </fieldset>\r\n              <fieldset class=\"form-group\">\r\n                <input\r\n                  v-model=\"password\"\r\n                  class=\"form-control form-control-lg\"\r\n                  type=\"password\"\r\n                  placeholder=\"New password\"\r\n                />\r\n              </fieldset>\r\n              <common-loader v-if=\"isLoading\" :size=\"5\" />\r\n              <button\r\n                v-else\r\n                class=\"btn btn-lg btn-primary pull-xs-right\"\r\n                @click=\"updateSettings\"\r\n              >\r\n                Update Settings\r\n              </button>\r\n            </fieldset>\r\n          </form>\r\n          <hr />\r\n          <button class=\"btn btn-outline-danger\" @click=\"logout\">\r\n            Or click here to logout.\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { Component, Vue, Watch } from \"vue-property-decorator\";\r\n\r\nimport CommonErrorsList from \"@/components/CommonErrorsList.vue\";\r\nimport CommonLoader from \"@/components/CommonLoader.vue\";\r\nimport { ICurrentUser } from \"@/store/models\";\r\nimport User from \"@/store/modules/User\";\r\nimport { isArrayOfStrings } from \"@/utils/ArrayUtils\";\r\n\r\n@Component({\r\n  components: {\r\n    CommonLoader,\r\n    CommonErrorsList\r\n  }\r\n})\r\nexport default class ProfileSettings extends Vue {\r\n  isLoading = false;\r\n\r\n  image: string | null = null;\r\n  bio = \"\";\r\n  email = \"\";\r\n  password: string | null = null;\r\n  username = \"\";\r\n  errors?: string[] = [];\r\n  selectedImage = null;\r\n\r\n  get hasErrors(): boolean {\r\n    return !!this.errors?.length;\r\n  }\r\n\r\n  get currentUser(): Partial<ICurrentUser> {\r\n    return User.currentUser || {};\r\n  }\r\n\r\n  logout(): void {\r\n    User.logout();\r\n    this.$router.push({ name: this.$routesNames.home });\r\n  }\r\n\r\n  uploadImage(event: Event): void{\r\n    this.selectedImage = (event?.target as HTMLInputElement).files[0];\r\n  }\r\n\r\n  async updateSettings(): Promise<void> {\r\n    this.errors = [];\r\n\r\n    const fd = new FormData();\r\n    fd.append('uploadImage', this.selectedImage);\r\n    fd.append('email', this.email);\r\n    fd.append('bio', this.bio);\r\n    fd.append('image', this.image);\r\n    fd.append('password', this.password);\r\n    fd.append('username', this.username);\r\n\r\n    this.isLoading = true;\r\n    try {\r\n      await User.update({\r\n        userUpdate: fd,\r\n      });\r\n      this.$router.push({ name: this.$routesNames.home });\r\n    } catch (e) {\r\n      if (isArrayOfStrings(e)) {\r\n        this.errors = e;\r\n      } else {\r\n        throw e;\r\n      }\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n  @Watch(\"currentUser\", { immediate: true })\r\n  onCurrentUserLoaded(newValue: ICurrentUser): void {\r\n    this.errors = [];\r\n    if (newValue) {\r\n      this.image = newValue.image;\r\n      this.bio = newValue.bio;\r\n      this.email = newValue.email;\r\n      this.username = newValue.username;\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}