{"remainingRequest":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\SVILUPPO\\test\\frontend-vue\\src\\views\\ProfileIndex.vue?vue&type=script&lang=ts&","dependencies":[{"path":"C:\\SVILUPPO\\test\\frontend-vue\\src\\views\\ProfileIndex.vue","mtime":1654014379738},{"path":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\ts-loader\\index.js","mtime":499162500000},{"path":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCmltcG9ydCB7IENvbXBvbmVudCwgVnVlIH0gZnJvbSAidnVlLXByb3BlcnR5LWRlY29yYXRvciI7DQoNCmltcG9ydCBDb21tb25GZWVkLCB7IElGZWVkVGFiIH0gZnJvbSAiQC9jb21wb25lbnRzL0NvbW1vbkZlZWQudnVlIjsNCmltcG9ydCBDb21tb25Mb2FkZXIgZnJvbSAiQC9jb21wb25lbnRzL0NvbW1vbkxvYWRlci52dWUiOw0KaW1wb3J0IFByb2ZpbGVGb2xsb3dCdXR0b24gZnJvbSAiQC9jb21wb25lbnRzL1Byb2ZpbGVGb2xsb3dCdXR0b24udnVlIjsNCmltcG9ydCB7IExvY2F0aW9uIH0gZnJvbSAiQC9yb3V0ZXIiOw0KaW1wb3J0IElQYWdpbmF0aW9uLCB7DQogIERFRkFVTFRfSVRFTVNfUEVSX1BBR0UsDQogIERFRkFVTFRfU1RBUlRfUEFHRQ0KfSBmcm9tICJAL3NlcnZpY2VzL2NvbW1vbi9JUGFnaW5hdGlvbiI7DQppbXBvcnQgeyBJQXJ0aWNsZUxpc3QsIElQcm9maWxlIH0gZnJvbSAiQC9zZXJ2aWNlcy9yZWFsV29ybGRBcGkvbW9kZWxzIjsNCmltcG9ydCBBcnRpY2xlIGZyb20gIkAvc3RvcmUvbW9kdWxlcy9BcnRpY2xlIjsNCmltcG9ydCBQcm9maWxlIGZyb20gIkAvc3RvcmUvbW9kdWxlcy9Qcm9maWxlIjsNCmltcG9ydCBVc2VyIGZyb20gIkAvc3RvcmUvbW9kdWxlcy9Vc2VyIjsNCg0KZW51bSBGZWVkVHlwZSB7DQogIEZhdm9yaXRlcyA9ICJmYXZvcml0ZXMiLA0KICBNeSA9ICJteSINCn0NCg0KQ29tcG9uZW50LnJlZ2lzdGVySG9va3MoWyJiZWZvcmVSb3V0ZUVudGVyIiwgImJlZm9yZVJvdXRlVXBkYXRlIl0pOw0KDQpAQ29tcG9uZW50KHsNCiAgY29tcG9uZW50czogew0KICAgIENvbW1vbkxvYWRlciwNCiAgICBDb21tb25GZWVkLA0KICAgIFByb2ZpbGVGb2xsb3dCdXR0b24NCiAgfQ0KfSkNCmV4cG9ydCBkZWZhdWx0IGNsYXNzIFByb2ZpbGVJbmRleCBleHRlbmRzIFZ1ZSB7DQogIF9wcm9maWxlOiBJUHJvZmlsZSA9IHsgdXNlcm5hbWU6ICIiLCBiaW86ICIiLCBpbWFnZTogIiIsIGZvbGxvd2luZzogZmFsc2UgfTsNCiAgaXNMb2FkaW5nID0gZmFsc2U7DQogIGlzRm9sbG93QWN0aW9uSW5Qcm9ncmVzcyA9IGZhbHNlOw0KICBjdXJyZW50UGFnZSA9IERFRkFVTFRfU1RBUlRfUEFHRTsNCiAgaXRlbXNQZXJQYWdlID0gREVGQVVMVF9JVEVNU19QRVJfUEFHRTsNCg0KICBhY3RpdmVUYWJJZDogRmVlZFR5cGUgPSBGZWVkVHlwZS5NeTsNCiAgYWN0aXZlRmVlZDogSUFydGljbGVMaXN0ID0geyBhcnRpY2xlczogW10sIGFydGljbGVzQ291bnQ6IDAgfTsNCiAgYWN0aXZlVGFnOiBzdHJpbmcgfCBudWxsID0gbnVsbDsNCg0KICBnZXQgcHJvZmlsZSgpOiBJUHJvZmlsZSB7DQogICAgcmV0dXJuIFByb2ZpbGUucHJvZmlsZXNDYWNoZVt0aGlzLl9wcm9maWxlPy51c2VybmFtZV0gfHwgdGhpcy5fcHJvZmlsZTsNCiAgfQ0KDQogIGdldCB0YWJzKCk6IElGZWVkVGFiW10gew0KICAgIGNvbnN0IG15VGl0bGUgPSB0aGlzLmlzTXlQcm9maWxlDQogICAgICA/ICJNeSBBcnRpY2xlcyINCiAgICAgIDogYCR7dGhpcy5wcm9maWxlLnVzZXJuYW1lfSdzIEFydGljbGVzYDsNCiAgICByZXR1cm4gWw0KICAgICAgew0KICAgICAgICBpZDogRmVlZFR5cGUuTXksDQogICAgICAgIHRpdGxlOiBteVRpdGxlDQogICAgICB9LA0KICAgICAgew0KICAgICAgICBpZDogRmVlZFR5cGUuRmF2b3JpdGVzLA0KICAgICAgICB0aXRsZTogIkZhdm9yaXRlZCBBcnRpY2xlcyINCiAgICAgIH0NCiAgICBdOw0KICB9DQoNCiAgZ2V0IGlzTXlQcm9maWxlKCk6IGJvb2xlYW4gew0KICAgIHJldHVybiB0aGlzLnByb2ZpbGUudXNlcm5hbWUgPT09IFVzZXIuY3VycmVudFVzZXI/LnVzZXJuYW1lOw0KICB9DQoNCiAgYmVmb3JlUm91dGVFbnRlcih0bzogTG9jYXRpb24sIGZyb206IExvY2F0aW9uLCBuZXh0OiBGdW5jdGlvbik6IHZvaWQgew0KICAgIG5leHQoKHZtOiBQcm9maWxlSW5kZXgpID0+IHsNCiAgICAgIHZtLm9uUm91dGVVcGRhdGUodG8sIGZyb20sIG5leHQpOw0KICAgIH0pOw0KICB9DQogIGJlZm9yZVJvdXRlVXBkYXRlKHRvOiBMb2NhdGlvbiwgZnJvbTogTG9jYXRpb24sIG5leHQ6IEZ1bmN0aW9uKTogdm9pZCB7DQogICAgdGhpcy5vblJvdXRlVXBkYXRlKHRvLCBmcm9tLCBuZXh0KTsNCiAgfQ0KDQogIGFzeW5jIG9uUm91dGVVcGRhdGUoDQogICAgdG86IExvY2F0aW9uLA0KICAgIGZyb206IExvY2F0aW9uLA0KICAgIG5leHQ6IEZ1bmN0aW9uDQogICk6IFByb21pc2U8dm9pZD4gew0KICAgIG5leHQoKTsNCg0KICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZTsNCiAgICB0cnkgew0KICAgICAgY29uc3QgdG9Vc2VyTmFtZSA9IHRvPy5wYXJhbXM/LnVzZXJuYW1lOw0KICAgICAgY29uc3QgZnJvbVVzZXJOYW1lID0gZnJvbT8ucGFyYW1zPy51c2VybmFtZTsNCiAgICAgIGlmICghdG9Vc2VyTmFtZSkgew0KICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6IHRoaXMuJHJvdXRlc05hbWVzLmhvbWUgfSk7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIGlmICh0b1VzZXJOYW1lICE9PSBmcm9tVXNlck5hbWUpIHsNCiAgICAgICAgdGhpcy5fcHJvZmlsZSA9IGF3YWl0IFByb2ZpbGUuZ2V0KHRvVXNlck5hbWUpOw0KICAgICAgfQ0KDQogICAgICBjb25zdCB0YWJJZCA9IHRvPy5wYXJhbXM/LnRhYklkOw0KICAgICAgaWYgKHRhYklkICYmIE9iamVjdC52YWx1ZXMoRmVlZFR5cGUpLnNvbWUodiA9PiAodiBhcyBzdHJpbmcpID09PSB0YWJJZCkpIHsNCiAgICAgICAgdGhpcy5hY3RpdmVUYWJJZCA9IHRhYklkIGFzIEZlZWRUeXBlOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy5hY3RpdmVUYWJJZCA9IEZlZWRUeXBlLk15Ow0KICAgICAgfQ0KDQogICAgICBhd2FpdCB0aGlzLmZldGNoRmVlZCgpOw0KICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZTogdGhpcy4kcm91dGVzTmFtZXMuaG9tZSB9KTsNCiAgICB9IGZpbmFsbHkgew0KICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTsNCiAgICB9DQogIH0NCg0KICBhc3luYyBvblRhYkNoYW5nZWQodGFiSWQ6IEZlZWRUeXBlKTogUHJvbWlzZTx2b2lkPiB7DQogICAgc3dpdGNoICh0YWJJZCkgew0KICAgICAgY2FzZSBGZWVkVHlwZS5NeToNCiAgICAgIGNhc2UgRmVlZFR5cGUuRmF2b3JpdGVzOg0KICAgICAgICB0aGlzLmFjdGl2ZVRhYklkID0gdGFiSWQ7DQogICAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSBERUZBVUxUX1NUQVJUX1BBR0U7DQogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsNCiAgICAgICAgICBwYXJhbXM6IHsgdXNlcm5hbWU6IHRoaXMucHJvZmlsZS51c2VybmFtZSwgdGFiSWQ6IHRoaXMuYWN0aXZlVGFiSWQgfQ0KICAgICAgICB9KTsNCiAgICAgICAgYXdhaXQgdGhpcy5mZXRjaEZlZWQoKTsNCiAgICAgICAgYnJlYWs7DQoNCiAgICAgIGRlZmF1bHQ6DQogICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5leHBlY3RlZCB0YWJJZDogJHt0YWJJZH1gKTsNCiAgICB9DQogIH0NCg0KICBhc3luYyBvblBhZ2VDaGFuZ2VkKHBhZ2U6IG51bWJlcik6IFByb21pc2U8dm9pZD4gew0KICAgIHRoaXMuY3VycmVudFBhZ2UgPSBwYWdlOw0KICAgIGF3YWl0IHRoaXMuZmV0Y2hGZWVkKCk7DQogIH0NCg0KICBhc3luYyBmZXRjaEZlZWQoKTogUHJvbWlzZTx2b2lkPiB7DQogICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlOw0KICAgIHRyeSB7DQogICAgICBjb25zdCBwYWdpbmF0aW9uOiBJUGFnaW5hdGlvbiA9IHsNCiAgICAgICAgbGltaXQ6IHRoaXMuaXRlbXNQZXJQYWdlLA0KICAgICAgICBvZmZzZXQ6ICh0aGlzLmN1cnJlbnRQYWdlIC0gMSkgKiB0aGlzLml0ZW1zUGVyUGFnZQ0KICAgICAgfTsNCg0KICAgICAgc3dpdGNoICh0aGlzLmFjdGl2ZVRhYklkKSB7DQogICAgICAgIGNhc2UgRmVlZFR5cGUuRmF2b3JpdGVzOg0KICAgICAgICAgIHRoaXMuYWN0aXZlRmVlZCA9IGF3YWl0IEFydGljbGUuZ2V0TGlzdCh7DQogICAgICAgICAgICBmYXZvcml0ZWQ6IHRoaXMucHJvZmlsZS51c2VybmFtZSwNCiAgICAgICAgICAgIC4uLnBhZ2luYXRpb24NCiAgICAgICAgICB9KTsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSBGZWVkVHlwZS5NeToNCiAgICAgICAgICB0aGlzLmFjdGl2ZUZlZWQgPSBhd2FpdCBBcnRpY2xlLmdldExpc3Qoew0KICAgICAgICAgICAgYXV0aG9yOiB0aGlzLnByb2ZpbGUudXNlcm5hbWUsDQogICAgICAgICAgICAuLi5wYWdpbmF0aW9uDQogICAgICAgICAgfSk7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgYnJlYWs7DQogICAgICB9DQogICAgfSBmaW5hbGx5IHsNCiAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7DQogICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7DQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["ProfileIndex.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ProfileIndex.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <common-loader v-if=\"isLoading || !profile\" />\r\n  <div v-else class=\"profile-page\">\r\n    <div class=\"user-info\">\r\n      <div class=\"container\">\r\n        <div class=\"row\">\r\n          <div class=\"col-xs-12 col-md-10 offset-md-1\">\r\n            <img :src=\"profile.image\" class=\"user-img\" />\r\n            <h4>{{ profile.username }}</h4>\r\n            <p>\r\n              {{ profile.bio }}\r\n            </p>\r\n\r\n            <router-link\r\n              v-if=\"isMyProfile\"\r\n              :to=\"{ name: $routesNames.profileSettings }\"\r\n              class=\"btn action-btn btn-sm btn-outline-secondary\"\r\n            >\r\n              <i class=\"ion-gear-a\"></i>\r\n              Edit Profile Settings\r\n            </router-link>\r\n            <profile-follow-button\r\n              v-else\r\n              :username=\"author.username\"\r\n              :following=\"author.following\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"container\">\r\n      <div class=\"row\">\r\n        <div class=\"col-xs-12 col-md-10 offset-md-1\">\r\n          <common-feed\r\n            :tabs=\"tabs\"\r\n            :active-tab-id=\"activeTabId\"\r\n            :is-loading=\"isLoading\"\r\n            :feed=\"activeFeed\"\r\n            :items-per-page=\"itemsPerPage\"\r\n            :current-page=\"currentPage\"\r\n            @page-changed=\"onPageChanged\"\r\n            @tab-changed=\"onTabChanged\"\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { Component, Vue } from \"vue-property-decorator\";\r\n\r\nimport CommonFeed, { IFeedTab } from \"@/components/CommonFeed.vue\";\r\nimport CommonLoader from \"@/components/CommonLoader.vue\";\r\nimport ProfileFollowButton from \"@/components/ProfileFollowButton.vue\";\r\nimport { Location } from \"@/router\";\r\nimport IPagination, {\r\n  DEFAULT_ITEMS_PER_PAGE,\r\n  DEFAULT_START_PAGE\r\n} from \"@/services/common/IPagination\";\r\nimport { IArticleList, IProfile } from \"@/services/realWorldApi/models\";\r\nimport Article from \"@/store/modules/Article\";\r\nimport Profile from \"@/store/modules/Profile\";\r\nimport User from \"@/store/modules/User\";\r\n\r\nenum FeedType {\r\n  Favorites = \"favorites\",\r\n  My = \"my\"\r\n}\r\n\r\nComponent.registerHooks([\"beforeRouteEnter\", \"beforeRouteUpdate\"]);\r\n\r\n@Component({\r\n  components: {\r\n    CommonLoader,\r\n    CommonFeed,\r\n    ProfileFollowButton\r\n  }\r\n})\r\nexport default class ProfileIndex extends Vue {\r\n  _profile: IProfile = { username: \"\", bio: \"\", image: \"\", following: false };\r\n  isLoading = false;\r\n  isFollowActionInProgress = false;\r\n  currentPage = DEFAULT_START_PAGE;\r\n  itemsPerPage = DEFAULT_ITEMS_PER_PAGE;\r\n\r\n  activeTabId: FeedType = FeedType.My;\r\n  activeFeed: IArticleList = { articles: [], articlesCount: 0 };\r\n  activeTag: string | null = null;\r\n\r\n  get profile(): IProfile {\r\n    return Profile.profilesCache[this._profile?.username] || this._profile;\r\n  }\r\n\r\n  get tabs(): IFeedTab[] {\r\n    const myTitle = this.isMyProfile\r\n      ? \"My Articles\"\r\n      : `${this.profile.username}'s Articles`;\r\n    return [\r\n      {\r\n        id: FeedType.My,\r\n        title: myTitle\r\n      },\r\n      {\r\n        id: FeedType.Favorites,\r\n        title: \"Favorited Articles\"\r\n      }\r\n    ];\r\n  }\r\n\r\n  get isMyProfile(): boolean {\r\n    return this.profile.username === User.currentUser?.username;\r\n  }\r\n\r\n  beforeRouteEnter(to: Location, from: Location, next: Function): void {\r\n    next((vm: ProfileIndex) => {\r\n      vm.onRouteUpdate(to, from, next);\r\n    });\r\n  }\r\n  beforeRouteUpdate(to: Location, from: Location, next: Function): void {\r\n    this.onRouteUpdate(to, from, next);\r\n  }\r\n\r\n  async onRouteUpdate(\r\n    to: Location,\r\n    from: Location,\r\n    next: Function\r\n  ): Promise<void> {\r\n    next();\r\n\r\n    this.isLoading = true;\r\n    try {\r\n      const toUserName = to?.params?.username;\r\n      const fromUserName = from?.params?.username;\r\n      if (!toUserName) {\r\n        this.$router.push({ name: this.$routesNames.home });\r\n        return;\r\n      }\r\n      if (toUserName !== fromUserName) {\r\n        this._profile = await Profile.get(toUserName);\r\n      }\r\n\r\n      const tabId = to?.params?.tabId;\r\n      if (tabId && Object.values(FeedType).some(v => (v as string) === tabId)) {\r\n        this.activeTabId = tabId as FeedType;\r\n      } else {\r\n        this.activeTabId = FeedType.My;\r\n      }\r\n\r\n      await this.fetchFeed();\r\n    } catch (e) {\r\n      this.$router.push({ name: this.$routesNames.home });\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n\r\n  async onTabChanged(tabId: FeedType): Promise<void> {\r\n    switch (tabId) {\r\n      case FeedType.My:\r\n      case FeedType.Favorites:\r\n        this.activeTabId = tabId;\r\n        this.currentPage = DEFAULT_START_PAGE;\r\n        this.$router.push({\r\n          params: { username: this.profile.username, tabId: this.activeTabId }\r\n        });\r\n        await this.fetchFeed();\r\n        break;\r\n\r\n      default:\r\n        throw new Error(`Unexpected tabId: ${tabId}`);\r\n    }\r\n  }\r\n\r\n  async onPageChanged(page: number): Promise<void> {\r\n    this.currentPage = page;\r\n    await this.fetchFeed();\r\n  }\r\n\r\n  async fetchFeed(): Promise<void> {\r\n    this.isLoading = true;\r\n    try {\r\n      const pagination: IPagination = {\r\n        limit: this.itemsPerPage,\r\n        offset: (this.currentPage - 1) * this.itemsPerPage\r\n      };\r\n\r\n      switch (this.activeTabId) {\r\n        case FeedType.Favorites:\r\n          this.activeFeed = await Article.getList({\r\n            favorited: this.profile.username,\r\n            ...pagination\r\n          });\r\n          break;\r\n        case FeedType.My:\r\n          this.activeFeed = await Article.getList({\r\n            author: this.profile.username,\r\n            ...pagination\r\n          });\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    } finally {\r\n      this.isLoading = false;\r\n      window.scrollTo(0, 0);\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}