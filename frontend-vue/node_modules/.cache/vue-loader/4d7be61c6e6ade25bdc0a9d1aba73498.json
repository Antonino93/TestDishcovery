{"remainingRequest":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\SVILUPPO\\test\\frontend-vue\\src\\views\\ArticleView.vue?vue&type=script&lang=ts&","dependencies":[{"path":"C:\\SVILUPPO\\test\\frontend-vue\\src\\views\\ArticleView.vue","mtime":1654014379738},{"path":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\ts-loader\\index.js","mtime":499162500000},{"path":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\SVILUPPO\\test\\frontend-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCmltcG9ydCBET01QdXJpZnkgZnJvbSAiZG9tcHVyaWZ5IjsNCmltcG9ydCBtYXJrZWQgZnJvbSAibWFya2VkIjsNCmltcG9ydCB7IENvbXBvbmVudCwgVnVlIH0gZnJvbSAidnVlLXByb3BlcnR5LWRlY29yYXRvciI7DQoNCmltcG9ydCBBcnRpY2xlQ29tbWVudHMgZnJvbSAiQC9jb21wb25lbnRzL0FydGljbGVDb21tZW50cy52dWUiOw0KaW1wb3J0IEFydGljbGVWaWV3QWN0aW9ucyBmcm9tICJAL2NvbXBvbmVudHMvQXJ0aWNsZVZpZXdBY3Rpb25zLnZ1ZSI7DQppbXBvcnQgQ29tbW9uTG9hZGVyIGZyb20gIkAvY29tcG9uZW50cy9Db21tb25Mb2FkZXIudnVlIjsNCmltcG9ydCB7IExvY2F0aW9uIH0gZnJvbSAiQC9yb3V0ZXIiOw0KaW1wb3J0IHsgSUFydGljbGUgfSBmcm9tICJAL3NlcnZpY2VzL3JlYWxXb3JsZEFwaS9tb2RlbHMiOw0KaW1wb3J0IEFydGljbGUgZnJvbSAiQC9zdG9yZS9tb2R1bGVzL0FydGljbGUiOw0KDQpDb21wb25lbnQucmVnaXN0ZXJIb29rcyhbImJlZm9yZVJvdXRlRW50ZXIiLCAiYmVmb3JlUm91dGVVcGRhdGUiXSk7DQoNCkBDb21wb25lbnQoew0KICBjb21wb25lbnRzOiB7DQogICAgQXJ0aWNsZVZpZXdBY3Rpb25zLA0KICAgIENvbW1vbkxvYWRlciwNCiAgICBBcnRpY2xlQ29tbWVudHMNCiAgfQ0KfSkNCmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFydGljbGVWaWV3IGV4dGVuZHMgVnVlIHsNCiAgaXNMb2FkaW5nID0gZmFsc2U7DQogIHNsdWcgPSAiIjsNCiAgX2FydGljbGU6IElBcnRpY2xlIHwgbnVsbCA9IG51bGw7DQoNCiAgZ2V0IGFydGljbGUoKTogSUFydGljbGUgew0KICAgIHJldHVybiBBcnRpY2xlLmFydGljbGVzQ2FjaGVbdGhpcy5zbHVnXSB8fCB0aGlzLl9hcnRpY2xlOw0KICB9DQoNCiAgZ2V0IEhUTUxCb2R5KCk6IHN0cmluZyB7DQogICAgY29uc3QgZGlydHlIdG1sID0gbWFya2VkKHRoaXMuYXJ0aWNsZS5ib2R5KTsNCiAgICByZXR1cm4gRE9NUHVyaWZ5LnNhbml0aXplKGRpcnR5SHRtbCk7DQogIH0NCg0KICBiZWZvcmVSb3V0ZUVudGVyKHRvOiBMb2NhdGlvbiwgZnJvbTogTG9jYXRpb24sIG5leHQ6IEZ1bmN0aW9uKTogdm9pZCB7DQogICAgbmV4dCgodm06IEFydGljbGVWaWV3KSA9PiB7DQogICAgICB2bS5vblJvdXRlVXBkYXRlKHRvLCBmcm9tLCBuZXh0KTsNCiAgICB9KTsNCiAgfQ0KICBiZWZvcmVSb3V0ZVVwZGF0ZSh0bzogTG9jYXRpb24sIGZyb206IExvY2F0aW9uLCBuZXh0OiBGdW5jdGlvbik6IHZvaWQgew0KICAgIHRoaXMub25Sb3V0ZVVwZGF0ZSh0bywgZnJvbSwgbmV4dCk7DQogIH0NCg0KICBhc3luYyBvblJvdXRlVXBkYXRlKA0KICAgIHRvOiBMb2NhdGlvbiwNCiAgICBmcm9tOiBMb2NhdGlvbiwNCiAgICBuZXh0OiBGdW5jdGlvbg0KICApOiBQcm9taXNlPHZvaWQ+IHsNCiAgICBuZXh0KCk7DQoNCiAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7DQogICAgdHJ5IHsNCiAgICAgIGNvbnN0IHRvU2x1ZyA9IHRvPy5wYXJhbXM/LnNsdWc7DQogICAgICBjb25zdCBmcm9tU2x1ZyA9IGZyb20/LnBhcmFtcz8uc2x1ZzsNCiAgICAgIGlmICghdG9TbHVnKSB7DQogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZTogdGhpcy4kcm91dGVzTmFtZXMuaG9tZSB9KTsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KICAgICAgaWYgKHRvU2x1ZyAhPT0gZnJvbVNsdWcpIHsNCiAgICAgICAgYXdhaXQgQXJ0aWNsZS5mZXRjaFNpbmdsZSh0b1NsdWcpOw0KICAgICAgICB0aGlzLnNsdWcgPSB0b1NsdWc7DQogICAgICB9DQogICAgfSBjYXRjaCAoZSkgew0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBuYW1lOiB0aGlzLiRyb3V0ZXNOYW1lcy5ob21lIH0pOw0KICAgIH0gZmluYWxseSB7DQogICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlOw0KICAgIH0NCiAgfQ0KDQogIGFzeW5jIG9uRGVsZXRlQXJ0aWNsZSgpOiBQcm9taXNlPHZvaWQ+IHsNCiAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7DQogICAgdHJ5IHsNCiAgICAgIGF3YWl0IEFydGljbGUuZGVsZXRlKHRoaXMuc2x1Zyk7DQogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6IHRoaXMuJHJvdXRlc05hbWVzLmhvbWUgfSk7DQogICAgfSBmaW5hbGx5IHsNCiAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7DQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["ArticleView.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ArticleView.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <common-loader v-if=\"isLoading || !article\" />\r\n\r\n  <div v-else class=\"article-page\">\r\n    <div class=\"banner\">\r\n      <div class=\"container\">\r\n        <h1>{{ article.title }}</h1>\r\n        <article-view-actions\r\n          :article=\"article\"\r\n          @delete-article=\"onDeleteArticle\"\r\n        />\r\n      </div>\r\n    </div>\r\n    <div class=\"container page\">\r\n      <div class=\"row article-content\">\r\n        <!-- eslint-disable-next-line vue/no-v-html -->\r\n        <div class=\"col-md-12\" v-html=\"HTMLBody\"></div>\r\n      </div>\r\n\r\n      <hr />\r\n\r\n      <div class=\"article-actions\">\r\n        <article-view-actions\r\n          :article=\"article\"\r\n          @delete-article=\"onDeleteArticle\"\r\n        />\r\n      </div>\r\n\r\n      <div class=\"row\">\r\n        <article-comments class=\"col-xs-12 col-md-8 offset-md-2\" :slug=\"slug\" />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport DOMPurify from \"dompurify\";\r\nimport marked from \"marked\";\r\nimport { Component, Vue } from \"vue-property-decorator\";\r\n\r\nimport ArticleComments from \"@/components/ArticleComments.vue\";\r\nimport ArticleViewActions from \"@/components/ArticleViewActions.vue\";\r\nimport CommonLoader from \"@/components/CommonLoader.vue\";\r\nimport { Location } from \"@/router\";\r\nimport { IArticle } from \"@/services/realWorldApi/models\";\r\nimport Article from \"@/store/modules/Article\";\r\n\r\nComponent.registerHooks([\"beforeRouteEnter\", \"beforeRouteUpdate\"]);\r\n\r\n@Component({\r\n  components: {\r\n    ArticleViewActions,\r\n    CommonLoader,\r\n    ArticleComments\r\n  }\r\n})\r\nexport default class ArticleView extends Vue {\r\n  isLoading = false;\r\n  slug = \"\";\r\n  _article: IArticle | null = null;\r\n\r\n  get article(): IArticle {\r\n    return Article.articlesCache[this.slug] || this._article;\r\n  }\r\n\r\n  get HTMLBody(): string {\r\n    const dirtyHtml = marked(this.article.body);\r\n    return DOMPurify.sanitize(dirtyHtml);\r\n  }\r\n\r\n  beforeRouteEnter(to: Location, from: Location, next: Function): void {\r\n    next((vm: ArticleView) => {\r\n      vm.onRouteUpdate(to, from, next);\r\n    });\r\n  }\r\n  beforeRouteUpdate(to: Location, from: Location, next: Function): void {\r\n    this.onRouteUpdate(to, from, next);\r\n  }\r\n\r\n  async onRouteUpdate(\r\n    to: Location,\r\n    from: Location,\r\n    next: Function\r\n  ): Promise<void> {\r\n    next();\r\n\r\n    this.isLoading = true;\r\n    try {\r\n      const toSlug = to?.params?.slug;\r\n      const fromSlug = from?.params?.slug;\r\n      if (!toSlug) {\r\n        this.$router.push({ name: this.$routesNames.home });\r\n        return;\r\n      }\r\n      if (toSlug !== fromSlug) {\r\n        await Article.fetchSingle(toSlug);\r\n        this.slug = toSlug;\r\n      }\r\n    } catch (e) {\r\n      this.$router.push({ name: this.$routesNames.home });\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n\r\n  async onDeleteArticle(): Promise<void> {\r\n    this.isLoading = true;\r\n    try {\r\n      await Article.delete(this.slug);\r\n      this.$router.push({ name: this.$routesNames.home });\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}